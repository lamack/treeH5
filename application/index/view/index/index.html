<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>首页</title>
    <link rel="stylesheet" type="text/css" href="{$static_dir}home/css/reset.css">
    <link rel="stylesheet" type="text/css" href="{$static_dir}home/css/index.css">
</head>

<body>
    <div class="container">
        <div class="blur_container hei">
            <div class="blur_bg"></div>
            <div class="blur_box none">
                <div class="item_row flex flex-justify-arround">
                    <div class="">
                        <img src="{$static_dir}home/img/green.png">
                        <p class="">{$_MEMBER.green_max|default=0}</p>
                    </div>
                    <div class="">
                        <img src="{$static_dir}home/img/dui.png">
                        <p class="">{$_MEMBER.green|default=0}</p>
                    </div>
                    <div class="">
                        <img src="{$static_dir}home/img/budui.png">
                        <p class="">{$_MEMBER.green_nocash|default=0}</p>
                    </div>
                    <div class="">
                        <img src="{$static_dir}home/img/hsf2.png">
                        <p class="">{$_MEMBER.share|default=0}</p>
                    </div>
                    <div class="">
                        <img src="{$static_dir}home/img/bigtree.png">
                        <p class="">{$count|default=1}</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="bomb">
            <div class="title">道具使用</div>
            <div class="close"></div>
            <div class="bomb-box">
                <div class="middle clearfix">
                    请选择使用或者兑换工具
                </div>
                <div class="bottom">
                    <div class="status">
                        <div class="use btn">使用</div>
                        <div class="exchange btn">兑换</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="tree">
            <div class="gethudun"><img src="{$static_dir}home/img/hudun1.png" /></div>
            <div class="old tree-box"><img src="{$static_dir}home/img/oldtree.png"></div>
            <div class="grow tree-box"><img src="{$static_dir}home/img/growtree.png"></div>
            <div class="child tree-box active"><img src="{$static_dir}home/img/childtree.png"></div>
            <!-- <div class="qipao">
                <div class="life-num">80</div>
                <div class="chengzhang">成长值</div>
                <div class="add move">+10</div>
                <div class="minus move">-10</div>
            </div> -->
        </div>
        <div class="blur_container col">
            <div class="blur_bg"></div>
            <div class="blur_box flex flex-col flex-justify-arround">
                <div class="item_col flex-1">
                    <a href="{:url('Adv/index')}" class="flex flex-align">
                        <div class="center">
                            <img src="{$static_dir}home/img/notice.png"> 公告
                        </div>
                    </a>
                </div>
                <div class="item_col flex-1">
                    <a href="{:url('TreesMap/index')}" class="flex flex-align">
                        <div class="center">
                            <img src="{$static_dir}home/img/mapicon.png"> 地图
                        </div>
                    </a>
                </div>
                <div class="item_col flex-1">
                    <a href="{:url('Task/index')}" class="flex flex-align">
                        <div class="center">
                            <img src="{$static_dir}home/img/taskicon.png"> 赚绿植
                        </div>
                    </a>
                </div>
            </div>
        </div>
        <div class="planting flex">
            <div class="planting-item flex-1 flex flex-justify-arround flex-align">
                <div class="item watering">
                    <div class="water act">
                        <img src="{$static_dir}home/img/water.png" class="water1">
                        <img src="{$static_dir}home/img/water2.png" class="water2">
                    </div>
                    <img src="{$static_dir}home/img/water.png"> x
                    <span class="num">{$waterprop|default=0}</span>
                    <div class="add1 one">+1</div>
                    <div class="minus1 one">-1</div>
                </div>
                <div class="item cutting">
                    <div class="cut act">
                        <img src="{$static_dir}home/img/cut.png" class="cut1">
                        <img src="{$static_dir}home/img/cut2.png" class="cut2">
                    </div>
                    <img src="{$static_dir}home/img/cut.png"> x
                    <span class="num">{$cutprop|default=0}</span>
                    <div class="add1 one">+1</div>
                    <div class="minus1 one">-1</div>
                </div>
                <div class="item feeding">
                    <div class="shifei act">
                        <img src="{$static_dir}home/img/shifei.png" class="shifei1">
                        <img src="{$static_dir}home/img/shifei1.png" class="shifei2">
                    </div>
                    <img src="{$static_dir}home/img/shifei.png"> x
                    <span class="num">{$shifeiprop|default=0}</span>
                    <div class="add1 one">+1</div>
                    <div class="minus1 one">-1</div>
                </div>
                <div class="item defense">
                    <img src="{$static_dir}home/img/hudun.png" class="hudun act">
                    <img src="{$static_dir}home/img/hudun.png"> x
                    <span class="num">{$hudunprop|default=0}</span>
                    <div class="add1 one">+1</div>
                    <div class="minus1 one">-1</div>
                </div>
            </div>
        </div>
        <div id="bottom">
            <div class="topbg"></div>
            <div class="ranking flex">
                <div class="ranking-item active flex-1 self">
                    个人排名
                </div>
                <div class="ranking-item flex-1 banzu">
                    班组排名
                </div>
                <div class="ranking-item flex-1 copm">
                    企业排名
                </div>
                <div class="ranking-item flex-1 area">
                    地区排名
                </div>
            </div>
            <div class="rank-box">
                <div class="rank-box-item active">
                    <div class="self-type flex">
                        <div class="self-type-item flex-1">司机达人</div>
                        <div class="self-type-item flex-1">植树达人</div>
                    </div>
                    <div class="self-type-box active">
                        <div class="rank-list flex self">
                             <div class="rank-num">{$me_rank.rank}</div>
                             <div class="self-icon"><img src=""></div>
                             <div class="self-name flex-1">{$me_rank.name}1</div>
                             <div class="self-num">{$me_rank.green_max}</div>
                         </div>
                         {volist name="person_rank" id="item" }
                            <div class="rank-list flex ">
                                 <div class="rank-num">{$key+1}</div>
                                 <div class="self-icon"><img src=""></div>
                                 <div class="self-name flex-1">{$item.username}</div>
                                 <div class="self-num">{$item.green_max}</div>
                             </div>
                        {/volist} 
                    </div>
                    <div class="self-type-box">
                        <div class="rank-list flex self">
                             <div class="rank-num">{$me_rank.rank}</div>
                             <div class="self-icon"><img src=""></div>
                             <div class="self-name flex-1">{$me_rank.name}</div>
                             <div class="self-num">{$me_rank.green_max}</div>
                         </div>
                         {volist name="driver_rank" id="item" }
                            <div class="rank-list flex ">
                                 <div class="rank-num">{$key+1}</div>
                                 <div class="self-icon"><img src=""></div>
                                 <div class="self-name flex-1">{$item.username}</div>
                                 <div class="self-num">{$item.green_max}</div>
                             </div>
                        {/volist} 
                    </div>
                </div>
                <div class="rank-box-item">
                   <div class="self-type flex">
                        <div class="self-type-item flex-1">排行榜</div>
                    </div>
                    <div class="self-type-box active">
                        {volist name="class_rank" id="item" }
                            <div class="rank-list flex ">
                                 <div class="rank-num">{$key+1}</div>
                                 <div class="self-icon"><img src=""></div>
                                 <div class="self-name flex-1">{$item.class}</div>
                                 <div class="self-num">{$item.max}</div>
                             </div>
                        {/volist} 
                    </div>
                </div>
                <div class="rank-box-item">
                    <div class="self-type flex">
                        <div class="self-type-item flex-1">排行榜</div>
                    </div>
                    <div class="self-type-box active">
                        {volist name="company_rank" id="item" }
                            <div class="rank-list flex ">
                                 <div class="rank-num">{$key+1}</div>
                                 <div class="self-icon"><img src=""></div>
                                 <div class="self-name flex-1">{$item.company}</div>
                                 <div class="self-num">{$item.max}</div>
                             </div>
                        {/volist} 
                    </div>
                </div>
                <div class="rank-box-item">
                    <div class="self-type flex">
                        <div class="self-type-item flex-1">区域</div>
                        <div class="self-type-item flex-1">产业局</div>
                    </div>
                    <div class="self-type-box active">
                        {volist name="area_rank" id="item" }
                            <div class="rank-list flex ">
                                 <div class="rank-num">{$key+1}</div>
                                 <div class="self-icon"><img src=""></div>
                                 <div class="self-name flex-1">{$item.area}</div>
                                 <div class="self-num">{$item.max}</div>
                             </div>
                        {/volist} 
                    </div>
                    <div class="self-type-box">66s</div>
                </div>
            </div>
        </div>
        <div class="hsf">
            <a href="javascript:;" class="">
                <img src="{$static_dir}home/img/hsf1.png">
                红色寻访
         </a>
        </div>
        <div class="me">
            <a href="{:url('Me/index')}" class="">
                <img src="{$static_dir}home/img/self.png">
                <p>{$_MEMBER.username}</p>
         </a>
        </div>
        <div class="disaster">
            <div class="hongshui">
                <img src="{$static_dir}home/img/hongshui1.png">
                <div class="inline"></div>
                <img src="{$static_dir}home/img/hongshui2.png">
            </div>
            <div class="cloud">
                <img src="{$static_dir}home/img/cloud.png">
            </div>
            <div class="ganhan"></div>
            <div class="taifeng">
                <img src="{$static_dir}home/img/taifeng.png">
            </div>
        </div>
        <div class="lunbo">
            <div class="lunbobg"></div>
            <div class="lunbobox">
                <div class="lunbo-container">
                    1.你好我符合双方计划来看2.还是减肥海景房hi3.武将半年时间考虑对4.方会我刘根据客户发生5.的风格留，的施肥hi厉害了
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="{$static_dir}home/js/zepto.js"></script>
    <script type="text/javascript" src="{$static_dir}home/js/public.js"></script>
    <script type="text/javascript" src="{$static_dir}home/js/touch.js"></script>
    <script type="text/javascript" src="{$static_dir}home/js/index.js"></script>
    <script type="text/javascript">
        var a = '{$tree|json_encode}';
        a = JSON.parse(a);
        var Tree = {
            tree:$('.tree').find('.tree-box'),
            tools:$('.planting').find('.item'),
            bomb:$('.bomb'),
            now:a,
            next:null,
            index:0,
            init:function(){
                this.next = this.now-1;
                this.bindEvent();
            },
            bindEvent:function(){
                var that = this;
                //点击工具
                this.tools.click(function(){
                    if($(this).index()==3) return;
                    that.index = $(this).index();
                    //兑换弹框显示
                    that.bomb.show()
                });
                // 点击使用
                this.bomb.find('.use').click(function(event) {
                    var data = {
                        url:'/prop?prop_type='+(that.index+1),
                        success:function(data){
                            console.log(data)
                        }
                    }
                    getData(data)
                    that.event(that.index);
                    that.bomb.hide();
                    //树苗成长
                    setTimeout(function(){
                        that.growing(that.now,that.next)
                        that.now --;
                        that.tools.find('.act').eq(that.index).removeClass('active')
                    },4000)
                });
                // 点击兑换
            },
            //植树效果
            event:function(i){
                var that = this;
                this.tools.find('.act').eq(i).addClass('active')
                // Handlecount.minus(i)
                /*setTimeout(function(){
                    that.qipao('add')
                },4000)*/
            },
            /*qipao(add){
                var el = $('.qipao').find('.life-num');
                var num = parseInt(el.html())
                if(add){
                    $('.qipao').find('.add').addClass('active')
                    num += 10;
                }else{
                    $('.qipao').find('.minus').addClass('active')
                    num -= 10;
                }
                el.html(num);
                setTimeout(function(){
                    $('.qipao').find('.minus').removeClass('active')
                    $('.qipao').find('.add').removeClass('active')
                },1500)
            },  */
            growing:function(now,next){
                var that = this;
                var heinow = this.tree.eq(now).height();
                var heinext = this.tree.eq(next).height();
                var per = heinext/heinow;
                this.tree.eq(now).css({
                    transform:'scale('+per+','+per+')',
                    opacity:0,
                })
                setTimeout(function(){  
                    that.tree.eq(next).css({
                        opacity:1,
                    })
                    that.next --;
                },1000)
            }
        }
        Tree.init();
    </script>
</body>

</html>